{{template "base" .}}

{{define "content"}}
<div class="card">
    <h1>æœç´¢ç»“æœ</h1>
    <form method="GET" action="/search" style="display: flex; gap: 1rem; margin: 1rem 0;">
        <input type="text" name="q" value="{{.query}}" class="form-control" placeholder="æœç´¢è§†é¢‘ã€ç”¨æˆ·..." style="flex: 1;">
        <select name="category" class="form-control" style="width: 150px;">
            <option value="">å…¨éƒ¨åˆ†ç±»</option>
            {{range $cat, $count := .categories}}
                <option value="{{$cat}}" {{if eq $cat $.category}}selected{{end}}>{{$cat}} ({{$count}})</option>
            {{end}}
        </select>
        <button type="submit" class="btn">æœç´¢</button>
    </form>
</div>

{{if .videos}}
<div class="card">
    <p>æ‰¾åˆ° {{len .videos}} ä¸ªç»“æœ{{if .query}} å…³äº "{{.query}}"{{end}}{{if .category}} åœ¨åˆ†ç±» "{{.category}}"{{end}}</p>
</div>

<div class="video-grid">
    {{range .videos}}
    <div class="video-card">
        <a href="/play/{{.VideoFilename}}">
            <img src="/static/uploads/covers/{{.CoverFilename}}" alt="{{.Title}}" class="video-thumbnail">
        </a>
        <div class="video-info">
            <h3 class="video-title">{{.Title}}</h3>
            <p style="color: #666; font-size: 0.9rem; margin-bottom: 0.5rem;">{{truncate .Description 60}}</p>
            <div class="video-meta">
                <span>{{.Uploader}}</span>
                <span>{{formatTime .UploadTime}}</span>
            </div>
            <div style="display: flex; justify-content: space-between; margin-top: 0.5rem;">
                <span style="color: #666; font-size: 0.85rem;">ğŸ‘ï¸ {{formatNumber .PlayCount}}</span>
                <span style="color: #666; font-size: 0.85rem;">â¤ï¸ {{formatNumber .LikeCount}}</span>
                <span style="color: #666; font-size: 0.85rem;">ğŸ’¬ {{formatNumber .CommentCount}}</span>
            </div>
        </div>
    </div>
    {{end}}
</div>
{{else}}
<div class="card">
    <p style="text-align: center; color: #666; padding: 2rem 0;">æ²¡æœ‰æ‰¾åˆ°ç›¸å…³è§†é¢‘</p>
</div>
{{end}}
{{end}}